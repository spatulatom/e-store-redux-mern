{"ast":null,"code":"import React,{useEffect,useRef,useState}from'react';import{LoadScript,GoogleMap,StandaloneSearchBox,Marker}from'@react-google-maps/api';import LoadingBox from'../components/LoadingBox';import Axios from'axios';import{USER_ADDRESS_MAP_CONFIRM}from'../constants/userConstants';import{useDispatch}from'react-redux';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const libs=['places'];const defaultLocation={lat:45.516,lng:-73.56};export default function MapScreen(props){const navigate=useNavigate();const[googleApiKey,setGoogleApiKey]=useState('');const[center,setCenter]=useState(defaultLocation);const[location,setLocation]=useState(center);const mapRef=useRef(null);const placeRef=useRef(null);const markerRef=useRef(null);useEffect(()=>{const fetch=async()=>{const{data}=await Axios(\"\".concat(process.env.REACT_APP_BACKEND_URL,\"/config/google\"));setGoogleApiKey(data);getUserCurrentLocation();};fetch();},[]);const onLoad=map=>{mapRef.current=map;};const onMarkerLoad=marker=>{markerRef.current=marker;};const onLoadPlaces=place=>{placeRef.current=place;};const onIdle=()=>{setLocation({lat:mapRef.current.center.lat(),lng:mapRef.current.center.lng()});};const onPlacesChanged=()=>{const place=placeRef.current.getPlaces()[0].geometry.location;setCenter({lat:place.lat(),lng:place.lng()});setLocation({lat:place.lat(),lng:place.lng()});};const dispatch=useDispatch();const onConfirm=()=>{const places=placeRef.current.getPlaces();if(places&&places.length===1){// dispatch select action\ndispatch({type:USER_ADDRESS_MAP_CONFIRM,payload:{lat:location.lat,lng:location.lng,address:places[0].formatted_address,name:places[0].name,vicinity:places[0].vicinity,googleAddressId:places[0].id}});alert('location selected successfully.');navigate('/shipping');}else{alert('Please enter your address');}};const getUserCurrentLocation=()=>{if(!navigator.geolocation){alert('Geolocation os not supported by this browser');}else{navigator.geolocation.getCurrentPosition(position=>{setCenter({lat:position.coords.latitude,lng:position.coords.longitude});setLocation({lat:position.coords.latitude,lng:position.coords.longitude});});}};return googleApiKey?/*#__PURE__*/_jsx(\"div\",{className:\"full-container allcomponents\",children:/*#__PURE__*/_jsx(LoadScript,{libraries:libs,googleMapsApiKey:googleApiKey,children:/*#__PURE__*/_jsxs(GoogleMap,{id:\"smaple-map\",mapContainerStyle:{height:'100%',width:'100%'},center:center,zoom:15,onLoad:onLoad,onIdle:onIdle,children:[/*#__PURE__*/_jsx(StandaloneSearchBox,{onLoad:onLoadPlaces,onPlacesChanged:onPlacesChanged,children:/*#__PURE__*/_jsxs(\"div\",{className:\"map-input-box\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Enter your address\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"primary\",onClick:onConfirm,children:\"Confirm\"})]})}),/*#__PURE__*/_jsx(Marker,{position:location,onLoad:onMarkerLoad})]})})}):/*#__PURE__*/_jsx(LoadingBox,{});}","map":{"version":3,"names":["React","useEffect","useRef","useState","LoadScript","GoogleMap","StandaloneSearchBox","Marker","LoadingBox","Axios","USER_ADDRESS_MAP_CONFIRM","useDispatch","useNavigate","jsx","_jsx","jsxs","_jsxs","libs","defaultLocation","lat","lng","MapScreen","props","navigate","googleApiKey","setGoogleApiKey","center","setCenter","location","setLocation","mapRef","placeRef","markerRef","fetch","data","concat","process","env","REACT_APP_BACKEND_URL","getUserCurrentLocation","onLoad","map","current","onMarkerLoad","marker","onLoadPlaces","place","onIdle","onPlacesChanged","getPlaces","geometry","dispatch","onConfirm","places","length","type","payload","address","formatted_address","name","vicinity","googleAddressId","id","alert","navigator","geolocation","getCurrentPosition","position","coords","latitude","longitude","className","children","libraries","googleMapsApiKey","mapContainerStyle","height","width","zoom","placeholder","onClick"],"sources":["D:/projects/e-store-redux-mern/frontend/src/screens/MapScreen.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\r\nimport {\r\n  LoadScript,\r\n  GoogleMap,\r\n  StandaloneSearchBox,\r\n  Marker,\r\n} from '@react-google-maps/api';\r\nimport LoadingBox from '../components/LoadingBox';\r\nimport Axios from 'axios';\r\nimport { USER_ADDRESS_MAP_CONFIRM } from '../constants/userConstants';\r\nimport { useDispatch } from 'react-redux';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst libs = ['places'];\r\nconst defaultLocation = { lat: 45.516, lng: -73.56 };\r\n\r\nexport default function MapScreen(props) {\r\n  const navigate = useNavigate();\r\n  const [googleApiKey, setGoogleApiKey] = useState('');\r\n  const [center, setCenter] = useState(defaultLocation);\r\n  const [location, setLocation] = useState(center);\r\n\r\n  const mapRef = useRef(null);\r\n  const placeRef = useRef(null);\r\n  const markerRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    const fetch = async () => {\r\n      const { data } = await Axios(`${process.env.REACT_APP_BACKEND_URL}/config/google`);\r\n      setGoogleApiKey(data);\r\n      getUserCurrentLocation();\r\n    };\r\n    fetch();\r\n  }, []);\r\n\r\n  const onLoad = (map) => {\r\n    mapRef.current = map;\r\n  };\r\n\r\n  const onMarkerLoad = (marker) => {\r\n    markerRef.current = marker;\r\n  };\r\n  const onLoadPlaces = (place) => {\r\n    placeRef.current = place;\r\n  };\r\n  const onIdle = () => {\r\n    setLocation({\r\n      lat: mapRef.current.center.lat(),\r\n      lng: mapRef.current.center.lng(),\r\n    });\r\n  };\r\n  const onPlacesChanged = () => {\r\n    const place = placeRef.current.getPlaces()[0].geometry.location;\r\n    setCenter({ lat: place.lat(), lng: place.lng() });\r\n    setLocation({ lat: place.lat(), lng: place.lng() });\r\n  };\r\n  const dispatch = useDispatch();\r\n  const onConfirm = () => {\r\n    const places = placeRef.current.getPlaces();\r\n    if (places && places.length === 1) {\r\n      // dispatch select action\r\n      dispatch({\r\n        type: USER_ADDRESS_MAP_CONFIRM,\r\n        payload: {\r\n          lat: location.lat,\r\n          lng: location.lng,\r\n          address: places[0].formatted_address,\r\n          name: places[0].name,\r\n          vicinity: places[0].vicinity,\r\n          googleAddressId: places[0].id,\r\n        },\r\n      });\r\n      alert('location selected successfully.');\r\n      navigate('/shipping');\r\n    } else {\r\n      alert('Please enter your address');\r\n    }\r\n  };\r\n\r\n  const getUserCurrentLocation = () => {\r\n    if (!navigator.geolocation) {\r\n      alert('Geolocation os not supported by this browser');\r\n    } else {\r\n      navigator.geolocation.getCurrentPosition((position) => {\r\n        setCenter({\r\n          lat: position.coords.latitude,\r\n          lng: position.coords.longitude,\r\n        });\r\n        setLocation({\r\n          lat: position.coords.latitude,\r\n          lng: position.coords.longitude,\r\n        });\r\n      });\r\n    }\r\n  };\r\n\r\n  return googleApiKey ? (\r\n    <div className=\"full-container allcomponents\">\r\n      <LoadScript libraries={libs} googleMapsApiKey={googleApiKey}>\r\n        <GoogleMap\r\n          id=\"smaple-map\"\r\n          mapContainerStyle={{ height: '100%', width: '100%' }}\r\n          center={center}\r\n          zoom={15}\r\n          onLoad={onLoad}\r\n          onIdle={onIdle}\r\n        >\r\n          <StandaloneSearchBox\r\n            onLoad={onLoadPlaces}\r\n            onPlacesChanged={onPlacesChanged}\r\n          >\r\n            <div className=\"map-input-box\">\r\n              <input type=\"text\" placeholder=\"Enter your address\"></input>\r\n              <button type=\"button\" className=\"primary\" onClick={onConfirm}>\r\n                Confirm\r\n              </button>\r\n            </div>\r\n          </StandaloneSearchBox>\r\n          <Marker position={location} onLoad={onMarkerLoad}></Marker>\r\n        </GoogleMap>\r\n      </LoadScript>\r\n    </div>\r\n  ) : (\r\n    <LoadingBox></LoadingBox>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}